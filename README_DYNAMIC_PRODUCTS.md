# 乐居商城动态商品系统

## 概述

本项目已经成功将商品展示从静态数据改为动态交互，使用数据库里的数据。现在商品页面可以动态加载商品信息，支持分类筛选、搜索、分页等功能。

## 系统架构

### 前端架构
- **Vue 3 + TypeScript**: 现代化的前端框架
- **Pinia**: 状态管理
- **Vue Router**: 路由管理
- **组件化设计**: 可复用的商品展示组件

### 后端架构
- **Node.js + Express**: 后端服务框架
- **MySQL**: 数据库存储
- **连接池**: 高效的数据库连接管理
- **RESTful API**: 标准的API接口设计

## 主要功能

### 1. 商品展示
- ✅ 动态加载商品数据
- ✅ 分类筛选
- ✅ 搜索功能
- ✅ 分页显示
- ✅ 排序功能（价格、人气、新品等）

### 2. 商品详情页
- ✅ 通用商品详情组件
- ✅ 动态路由参数
- ✅ 图片展示
- ✅ 数量选择
- ✅ 加入购物车
- ✅ 相关商品推荐

### 3. 分类管理
- ✅ 动态分类加载
- ✅ 分类筛选商品
- ✅ 面包屑导航

## 文件结构

```
src/
├── components/
│   ├── HomePage.vue          # 首页商品展示
│   ├── ProductDetailPage.vue # 商品详情页（通用组件）
│   └── ...
├── stores/
│   └── catalogStore.ts       # 商品数据状态管理
├── services/
│   └── api.ts               # API服务层
└── ...

server/
├── app.js                   # 服务器入口
├── productRouter.js         # 商品相关路由
├── productService.js        # 商品业务逻辑
└── sql/                     # 数据库脚本
    ├── leju_simple.sql      # 数据库结构
    └── insert_products.sql  # 商品数据
```

## API接口

### 商品相关
- `GET /api/products` - 获取所有商品
- `GET /api/products/:id` - 获取单个商品详情
- `GET /api/products/category/:categoryId` - 按分类获取商品
- `GET /api/products/hot` - 获取热门商品
- `GET /api/products/search` - 搜索商品

### 分类相关
- `GET /api/categories` - 获取所有分类

## 数据库设计

### 主要表结构
- `products`: 商品信息表
- `categories`: 分类信息表
- `cart_items`: 购物车项目表
- `orders`: 订单表
- `order_items`: 订单项目表

### 商品表字段
- `id`: 商品ID
- `name`: 商品名称
- `description`: 商品描述
- `price`: 商品价格
- `stock`: 库存数量
- `main_image`: 主图片URL
- `is_hot`: 是否热门
- `is_new`: 是否新品
- `category_id`: 分类ID
- `created_at`: 创建时间

## 使用方法

### 1. 启动数据库
确保MySQL服务正在运行，并创建了`leju_simple`数据库。

### 2. 启动后端服务
```bash
cd server
npm install
npm run server
```

### 3. 启动前端服务
```bash
npm install
npm run dev
```

### 4. 访问应用
- 首页: http://localhost:5173/
- 商品详情: http://localhost:5173/product/{商品ID}

## 核心特性

### 1. 动态数据加载
- 商品数据从数据库动态获取
- 支持实时搜索和筛选
- 分页加载，提升性能

### 2. 通用组件设计
- `ProductDetailPage.vue` 是通用组件
- 通过路由参数动态加载不同商品
- 避免重复代码，提高维护性

### 3. 响应式设计
- 支持移动端和桌面端
- 自适应布局
- 良好的用户体验

### 4. 错误处理
- 加载状态显示
- 错误信息提示
- 重试机制

## 扩展建议

### 1. 性能优化
- 添加Redis缓存
- 图片懒加载
- 虚拟滚动

### 2. 功能增强
- 商品评价系统
- 收藏功能
- 商品对比
- 推荐算法

### 3. 用户体验
- 骨架屏加载
- 无限滚动
- 搜索建议
- 历史记录

## 技术亮点

1. **前后端分离**: 清晰的API接口设计
2. **类型安全**: TypeScript提供完整的类型检查
3. **状态管理**: 使用Pinia管理复杂状态
4. **组件复用**: 通用商品详情组件设计
5. **数据库优化**: 连接池和索引优化
6. **错误处理**: 完善的错误处理机制

## 总结

通过这次重构，我们成功地将静态商品展示改为了动态交互系统。主要优势包括：

- 🚀 **性能提升**: 动态加载，按需获取数据
- 🔧 **维护性**: 通用组件，减少重复代码
- 📱 **用户体验**: 响应式设计，加载状态提示
- 🗄️ **数据管理**: 统一的数据库存储和管理
- 🔌 **扩展性**: 清晰的架构，易于功能扩展

系统现在可以支持大量商品数据，提供流畅的用户体验，并且具有良好的可维护性和扩展性。
